<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Asha & Bandhu â€” Care Assistants</title>
<style>
body{font-family:Poppins,sans-serif;background:#f6f8fb;color:#111;text-align:center;padding:28px;}
h1{color:#0b5cff;margin-bottom:1rem;}
#card{background:#fff;border-radius:12px;max-width:760px;margin:auto;padding:20px;box-shadow:0 6px 24px rgba(9,30,66,0.08);text-align:left;}
button{background:#0b5cff;color:white;border:none;padding:10px 18px;border-radius:8px;cursor:pointer;font-weight:600;margin:8px;}
button:hover{background:#004fcc;}
#status{font-weight:600;margin-top:10px;}
#transcript{background:#f8fafc;border-radius:8px;padding:12px;margin-top:12px;min-height:90px;}
</style>
</head>

<body>
<h1>ğŸ©º Asha â€” Voice Health Assistant</h1>

<div id="card">
  <p>Speak naturally with Asha. Sheâ€™ll understand your symptoms and help book a doctor appointment for you.</p>
  <button id="startBtn">ğŸ¤ Talk to Asha</button>
  <button id="stopBtn">â¹ Stop</button>
  <button id="bandhuBtn" style="background:#19a974;">ğŸ¤ Meet Bandhu (Health Helpers)</button>
  <div id="status">Status: idle</div>
  <div id="transcript"><em>Transcript will appear here.</em></div>
</div>

<script>
const SPECIALTIES={
  "Cardiologist":["heart","chest pain","palpitation","bp","blood pressure"],
  "Gastroenterologist":["stomach","acidity","heartburn","vomit","diarrhea","ulcer"],
  "Dermatologist":["skin","rash","itch","acne","eczema"],
  "Neurologist":["headache","migraine","dizzy","seizure","numbness"],
  "ENT":["ear","nose","throat","sinus","hearing"],
  "General Physician":["fever","cold","cough","tired","body ache"]
};
const PACKAGES={
  "Cardiologist":"â¤ï¸ Heart Checkup Package",
  "Gastroenterologist":"ğŸ½ï¸ Digestive Wellness Plan",
  "Dermatologist":"ğŸ’† Skin & Allergy Test",
  "Neurologist":"ğŸ§  Neuro Health Screening",
  "ENT":"ğŸ‘‚ ENT Complete Check",
  "General Physician":"ğŸ©º Full Body Health Package"
};
let data={symptoms:null,specialist:null,date:null,time:null,area:null,package:null};
let recognition;

function speak(t,next){
  const u=new SpeechSynthesisUtterance(t);
  u.lang='en-IN';u.pitch=1.1;u.rate=0.95;
  u.voice=speechSynthesis.getVoices().find(v=>/female/i.test(v.name)&&/en-IN|en-GB|en-US/.test(v.lang))||null;
  u.onend=()=>next&&next();speechSynthesis.cancel();speechSynthesis.speak(u);
}
function listen(prompt,cb){
  speak(prompt,()=>{
    const SR=window.SpeechRecognition||window.webkitSpeechRecognition;
    if(!SR){alert("Speech Recognition not supported here.");return;}
    recognition=new SR();recognition.lang='en-IN';
    recognition.onresult=e=>cb(e.results[0][0].transcript);
    recognition.start();
  });
}
function getSpecialist(t){t=t.toLowerCase();let best="General Physician",max=0;
for(const s in SPECIALTIES){let c=0;for(const k of SPECIALTIES[s])if(t.includes(k))c++;if(c>max){max=c;best=s;}}return best;}
const yes=t=>/yes|yeah|sure|ok|okay/i.test(t);

function start(){
  document.getElementById('transcript').textContent="";
  speak("Hi! Iâ€™m Asha, your friendly health assistant. How are you feeling today?",()=>askSymptoms());
}
function askSymptoms(){
  listen("Please tell me your symptoms in short.",t=>{
    data.symptoms=t;data.specialist=getSpecialist(t);
    speak("Got it. You may need a "+data.specialist+".",()=>askBook());
  });
}
function askBook(){
  listen("Would you like me to book an appointment for you?",t=>{
    if(yes(t))askDetails();else speak("Alright! I hope you feel better soon.");
  });
}
function askDetails(){
  speak("Your details will be taken from your logged-in account.",()=>askDate());
}
function askDate(){
  listen("When would you like to visit the doctor?",t=>{data.date=t;askTime();});
}
function askTime(){
  listen("What time works for you? Morning or afternoon?",t=>{data.time=t;askArea();});
}
function askArea(){
  listen("Which area is convenient for you?",t=>{data.area=t;askPackage();});
}
function askPackage(){
  listen("Would you like to add a health package as well?",t=>{
    if(yes(t)){data.package=PACKAGES[data.specialist]||PACKAGES["General Physician"];
      speak("Based on your symptoms, I suggest the "+data.package+".",finish);
    }else finish();
  });
}
function finish(){
  speak("Thank you! Redirecting you to available doctors now.",()=>{
    const q=new URLSearchParams(data).toString();
    window.location.href="doctors.html?"+q;
  });
}
document.getElementById('startBtn').onclick=start;
document.getElementById('stopBtn').onclick=()=>speechSynthesis.cancel();
document.getElementById('bandhuBtn').onclick=()=>window.location.href="bandhu.html";
</script>
</body>
</html>
