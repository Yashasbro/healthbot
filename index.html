<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Asha – Health Voice Assistant</title>
<style>
body{font-family:'Poppins',sans-serif;background:#f7f9fc;margin:0;color:#222;}
.header{background:#0b5cff;color:white;text-align:center;padding:1rem 0;font-size:1.5rem;font-weight:600;}
.container{max-width:800px;margin:40px auto;background:white;padding:30px;border-radius:14px;box-shadow:0 4px 20px rgba(0,0,0,0.1);}
button{background:#0b5cff;color:white;border:none;padding:10px 18px;border-radius:8px;font-size:1rem;cursor:pointer;margin:8px;}
button:hover{background:#0946c1;}
#bandhuBtn{background:#19a974;}
#bandhuBtn:hover{background:#148a62;}
#status{margin-top:12px;font-weight:600;}
#transcript{background:#f1f3f6;padding:15px;border-radius:10px;margin-top:15px;text-align:left;font-size:15px;min-height:80px;}
</style>
</head>

<body>
<div class="header">🩺 Asha – Your Caring Health Assistant</div>
<div class="container">
  <p>Hi! I’m Asha, your health assistant. Just talk to me naturally — I’ll understand your problem and help you find the right doctor.</p>
  <button id="startBtn">🎤 Talk to Asha</button>
  <button id="stopBtn">⏹ Stop</button>
  <button id="bandhuBtn">🤝 Meet Bandhu (Care Helpers)</button>
  <div id="status">Status: Idle</div>
  <div id="transcript"><em>Transcript will appear here...</em></div>
</div>

<script>
const SPECIALTIES={
 "Cardiologist":["heart","chest pain","bp","pressure","palpitation"],
 "Gastroenterologist":["stomach","vomit","indigestion","acid","heartburn"],
 "Dermatologist":["skin","itch","rash","acne"],
 "Neurologist":["headache","migraine","dizzy","seizure"],
 "ENT":["ear","nose","throat","sinus","hearing"],
 "General Physician":["fever","cold","cough","pain","body ache"]
};
const PACKAGES={
 "Cardiologist":"❤️ Heart Checkup Package",
 "Gastroenterologist":"🍽️ Digestive Wellness Plan",
 "Dermatologist":"💆 Skin & Allergy Test",
 "Neurologist":"🧠 Neuro Health Screening",
 "ENT":"👂 ENT Complete Check",
 "General Physician":"🩺 Full Body Health Package"
};

let recognition;
let data={symptoms:"",specialist:"",datetime:"",area:"",package:""};
const transcript=document.getElementById('transcript');
const statusBox=document.getElementById('status');

function speak(txt,next){
 const u=new SpeechSynthesisUtterance(txt);
 u.lang="en-IN";u.pitch=1.1;u.rate=0.95;
 const v=speechSynthesis.getVoices().find(v=>/female/i.test(v.name)&&/en-IN|en-GB|en-US/.test(v.lang));
 if(v)u.voice=v;
 u.onend=()=>next&&next();
 speechSynthesis.cancel();
 speechSynthesis.speak(u);
 statusBox.textContent="Asha: "+txt;
}

function listen(prompt,cb){
 speak(prompt,()=>{
   const SR=window.SpeechRecognition||window.webkitSpeechRecognition;
   if(!SR){alert("Speech Recognition not supported.");return;}
   recognition=new SR();recognition.lang="en-IN";
   recognition.onresult=e=>{
     const txt=e.results[0][0].transcript;
     transcript.innerHTML+=`<p><strong>You:</strong> ${txt}</p>`;
     cb(txt);
   };
   recognition.onerror=()=>speak("Sorry, I couldn't hear that clearly.",()=>cb(""));
   recognition.start();
 });
}

function getSpecialist(t){
 let best="General Physician",max=0;t=t.toLowerCase();
 for(const s in SPECIALTIES){
   let c=0;
   for(const k of SPECIALTIES[s])if(t.includes(k))c++;
   if(c>max){best=s;max=c;}
 }
 return best;
}
const yes=t=>/yes|yeah|ok|okay|sure/i.test(t);

function start(){
 transcript.innerHTML="";
 speak("Hi there! I’m Asha. How are you feeling today?",()=>askSymptoms());
}

function askSymptoms(){
 listen("Please tell me your symptoms in a few words, dear.",t=>{
   data.symptoms=t;
   data.specialist=getSpecialist(t);
   speak(`I understand. It sounds like you may need a ${data.specialist}.`,()=>askBooking());
 });
}

function askBooking(){
 listen("Would you like me to book a doctor appointment for you?",t=>{
   if(yes(t)){speak("Okay, I’ll take your details from your account.",()=>askTimeAndArea());}
   else speak("Alright, take care and rest well. I’m here whenever you need help.");
 });
}

function askTimeAndArea(){
 listen("When and where would you prefer your appointment, like tomorrow morning in Koramangala?",t=>{
   data.datetime=t;
   data.area=t;
   speak("Got it.",()=>askPackage());
 });
}

function askPackage(){
 listen("Would you like to add a small health check package for better care?",t=>{
   if(yes(t)){
     data.package=PACKAGES[data.specialist];
     speak(`Perfect. I’ll include the ${data.package}.`,finish);
   } else finish();
 });
}

function finish(){
 speak("All set! I’ll show you doctors you can consult now.",()=>{
   const q=new URLSearchParams(data).toString();
   window.location.href="doctors.html?"+q;
 });
}

document.getElementById('startBtn').onclick=()=>{speechSynthesis.cancel();start();};
document.getElementById('stopBtn').onclick=()=>{if(recognition)recognition.stop();speechSynthesis.cancel();statusBox.textContent="Stopped.";};
document.getElementById('bandhuBtn').onclick=()=>window.location.href='bandhu.html';
speechSynthesis.onvoiceschanged=()=>{};
</script>
</body>
</html>
