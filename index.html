<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Asha ‚Äì Health Voice Assistant</title>
<style>
body{font-family:'Poppins',sans-serif;background:#f7f9fc;margin:0;color:#222;}
.header{background:#0b5cff;color:white;text-align:center;padding:1rem 0;font-size:1.5rem;font-weight:600;}
.container{max-width:800px;margin:40px auto;background:white;padding:30px;border-radius:14px;box-shadow:0 4px 20px rgba(0,0,0,0.1);}
button{background:#0b5cff;color:white;border:none;padding:10px 18px;border-radius:8px;font-size:1rem;cursor:pointer;margin:8px;}
button:hover{background:#0946c1;}
#bandhuBtn{background:#19a974;}
#bandhuBtn:hover{background:#148a62;}
#status{margin-top:12px;font-weight:600;}
#transcript{background:#f1f3f6;padding:15px;border-radius:10px;margin-top:15px;text-align:left;font-size:15px;min-height:80px;}
</style>
</head>

<body>
<div class="header">ü©∫ Asha ‚Äì Voice Health Assistant</div>
<div class="container">
  <p>Hi! I‚Äôm Asha, your friendly assistant. Talk to me about how you feel, and I‚Äôll find doctors or helpers for you.</p>
  <button id="startBtn">üé§ Talk to Asha</button>
  <button id="stopBtn">‚èπ Stop</button>
  <button id="bandhuBtn">ü§ù Meet Bandhu (Care Helpers)</button>
  <div id="status">Status: Idle</div>
  <div id="transcript"><em>Transcript will appear here...</em></div>
</div>

<script>
const SPECIALTIES={
 "Cardiologist":["heart","chest pain","bp","pressure","palpitation"],
 "Gastroenterologist":["stomach","vomit","indigestion","acid","heartburn"],
 "Dermatologist":["skin","itch","rash","acne"],
 "Neurologist":["headache","migraine","dizzy","seizure"],
 "ENT":["ear","nose","throat","sinus","hearing"],
 "General Physician":["fever","cold","cough","pain","body ache"]
};
const PACKAGES={
 "Cardiologist":"‚ù§Ô∏è Heart Checkup Package",
 "Gastroenterologist":"üçΩÔ∏è Digestive Wellness Plan",
 "Dermatologist":"üíÜ Skin & Allergy Test",
 "Neurologist":"üß† Neuro Health Screening",
 "ENT":"üëÇ ENT Complete Check",
 "General Physician":"ü©∫ Full Body Health Package"
};
let recognition;
let data={symptoms:"",specialist:"",date:"",time:"",area:"",package:"",autobook:false};

const transcript=document.getElementById('transcript');
const statusBox=document.getElementById('status');

function speak(txt,next){
 const u=new SpeechSynthesisUtterance(txt);
 u.lang="en-IN";u.pitch=1.1;u.rate=0.95;
 const v=speechSynthesis.getVoices().find(v=>/female/i.test(v.name)&&/en-IN|en-GB|en-US/.test(v.lang));
 if(v)u.voice=v;
 u.onend=()=>next&&next();
 speechSynthesis.cancel();
 speechSynthesis.speak(u);
 statusBox.textContent="Asha: "+txt;
}

function listen(prompt,cb){
 speak(prompt,()=>{
   const SR=window.SpeechRecognition||window.webkitSpeechRecognition;
   if(!SR){alert("Speech Recognition not supported.");return;}
   recognition=new SR();recognition.lang="en-IN";
   recognition.onresult=e=>{
     const txt=e.results[0][0].transcript;
     transcript.innerHTML+=`<p><strong>You:</strong> ${txt}</p>`;
     cb(txt);
   };
   recognition.onerror=()=>speak("Sorry, I couldn't hear that properly.",()=>cb(""));
   recognition.start();
 });
}

function getSpecialist(t){
 let best="General Physician",max=0;t=t.toLowerCase();
 for(const s in SPECIALTIES){
   let c=0;
   for(const k of SPECIALTIES[s])if(t.includes(k))c++;
   if(c>max){best=s;max=c;}
 }
 return best;
}
const yes=t=>/yes|yeah|ok|okay|sure/i.test(t);

function start(){
 transcript.innerHTML="";
 speak("Hi! I'm Asha. How are you feeling today?",()=>askSymptoms());
}

function askSymptoms(){
 listen("Please tell me your symptoms briefly.",t=>{
   data.symptoms=t;
   data.specialist=getSpecialist(t);
   speak(`I see. You might need a ${data.specialist}.`,()=>askBook());
 });
}

function askBook(){
 listen("Would you like me to book an appointment for you?",t=>{
   if(yes(t)){data.autobook=true;speak("Okay. I‚Äôll use your account details for the booking.",()=>askDate());}
   else speak("Alright. I hope you feel better soon!");
 });
}

function askDate(){
 listen("When would you like to visit the doctor?",t=>{data.date=t;askTime();});
}

function askTime(){
 listen("What time works best for you? Morning or afternoon?",t=>{data.time=t;askArea();});
}

function askArea(){
 listen("Which area is convenient for you?",t=>{data.area=t;askPackage();});
}

function askPackage(){
 listen("Would you like to include a health package as well?",t=>{
   if(yes(t)){
     data.package=PACKAGES[data.specialist];
     speak(`I recommend the ${data.package}.`,finish);
   } else finish();
 });
}

function finish(){
 speak("Thank you! Redirecting you to the available doctors.",()=>{
   const q=new URLSearchParams(data).toString();
   window.location.href="doctors.html?"+q;
 });
}

document.getElementById('startBtn').onclick=()=>{speechSynthesis.cancel();start();};
document.getElementById('stopBtn').onclick=()=>{if(recognition)recognition.stop();speechSynthesis.cancel();statusBox.textContent="Stopped.";};
document.getElementById('bandhuBtn').onclick=()=>window.location.href='bandhu.html';
speechSynthesis.onvoiceschanged=()=>{};
</script>
</body>
</html>
