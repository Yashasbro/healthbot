<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Asha ‚Äî Health Voice Assistant</title>
<style>
body {font-family:Poppins,sans-serif;background:#f5f7fa;color:#111;text-align:center;padding:32px;}
h1{color:#0b5cff;margin-bottom:1rem;}
#card{background:#fff;border-radius:12px;padding:24px;max-width:700px;margin:auto;box-shadow:0 6px 20px rgba(0,0,0,0.1);}
button{background:#0b5cff;color:#fff;border:none;padding:10px 18px;border-radius:8px;cursor:pointer;font-weight:600;margin:8px;}
button:hover{background:#004fcc;}
#status{font-weight:600;margin-top:10px;}
#transcript{background:#f1f3f5;border-radius:8px;padding:12px;margin-top:12px;text-align:left;font-size:15px;min-height:100px;}
</style>
</head>

<body>
<h1>ü©∫ Asha ‚Äî Health Voice Assistant</h1>
<div id="card">
  <p>Talk to Asha about your symptoms. She will help find the right doctor.</p>
  <button id="startBtn">üé§ Talk to Asha</button>
  <button id="stopBtn">‚èπ Stop</button>
  <div id="status">Status: idle</div>
  <div id="transcript"><em>Transcript will appear here...</em></div>
</div>

<script>
const SPECIALTIES = {
  "Cardiologist":["heart","chest pain","bp","blood pressure","palpitation"],
  "Gastroenterologist":["stomach","acid","vomit","indigestion","heartburn"],
  "Dermatologist":["skin","itch","rash","acne"],
  "Neurologist":["headache","migraine","dizzy","seizure"],
  "ENT":["ear","nose","throat","sinus","hearing"],
  "General Physician":["fever","cold","cough","pain","body ache"]
};
const PACKAGES = {
  "Cardiologist":"‚ù§Ô∏è Heart Checkup Package",
  "Gastroenterologist":"üçΩÔ∏è Digestive Wellness Plan",
  "Dermatologist":"üíÜ Skin & Allergy Test",
  "Neurologist":"üß† Neuro Health Screening",
  "ENT":"üëÇ ENT Complete Check",
  "General Physician":"ü©∫ Full Body Health Package"
};
let rec,data={symptoms:"",specialist:"",date:"",time:"",area:"",package:""};
const transcript=document.getElementById("transcript");
const statusBox=document.getElementById("status");

function speak(txt,next){
  const u=new SpeechSynthesisUtterance(txt);
  u.lang="en-IN";u.rate=0.95;u.pitch=1.1;
  const v=speechSynthesis.getVoices().find(x=>/female/i.test(x.name)&&/en-IN|en-GB|en-US/.test(x.lang));
  if(v)u.voice=v;
  u.onend=()=>next&&next();
  speechSynthesis.cancel();
  speechSynthesis.speak(u);
  statusBox.textContent="Asha: "+txt;
}
function listen(prompt,cb){
  speak(prompt,()=>{
    const SR=window.SpeechRecognition||window.webkitSpeechRecognition;
    if(!SR){alert("Speech Recognition not supported");return;}
    rec=new SR();rec.lang="en-IN";
    rec.onresult=e=>{
      const t=e.results[0][0].transcript;
      transcript.innerHTML+=`<p><strong>You:</strong> ${t}</p>`;
      cb(t);
    };
    rec.onerror=()=>speak("Sorry, I couldn't hear that clearly.",()=>cb(""));
    rec.start();
  });
}
function getSpec(t){t=t.toLowerCase();let best="General Physician",max=0;
  for(const s in SPECIALTIES){let c=0;for(const k of SPECIALTIES[s])if(t.includes(k))c++;if(c>max){max=c;best=s;}}
  return best;
}
const yes=t=>/yes|yeah|sure|ok/i.test(t);
function start(){
  transcript.innerHTML="";
  speak("Hi! I‚Äôm Asha, your friendly health assistant. How are you feeling today?",()=>askSymptoms());
}
function askSymptoms(){
  listen("Please tell me what symptoms you have.",t=>{
    data.symptoms=t;data.specialist=getSpec(t);
    speak(`Got it. You may need a ${data.specialist}.`,()=>askBook());
  });
}
function askBook(){
  listen("Would you like me to book an appointment for you?",t=>{
    if(yes(t)){speak("Okay, your details will be taken from your logged-in account.",()=>askDate());}
    else speak("Okay, take care and get well soon!");
  });
}
function askDate(){
  listen("When would you like to visit the doctor?",t=>{data.date=t;askTime();});
}
function askTime(){
  listen("What time suits you best? Morning or afternoon?",t=>{data.time=t;askArea();});
}
function askArea(){
  listen("Which area is convenient for you?",t=>{data.area=t;askPackage();});
}
function askPackage(){
  listen("Would you like to include a health package too?",t=>{
    if(yes(t)){data.package=PACKAGES[data.specialist];speak(`I suggest the ${data.package}.`,finish);}
    else finish();
  });
}
function finish(){
  speak("Thank you. Redirecting you to available doctors now.",()=>{
    const q=new URLSearchParams(data).toString();
    window.location.href="doctors.html?"+q;
  });
}
document.getElementById("startBtn").onclick=()=>{speechSynthesis.cancel();start();};
document.getElementById("stopBtn").onclick=()=>{if(rec)rec.stop();speechSynthesis.cancel();statusBox.textContent="Stopped.";}
speechSynthesis.onvoiceschanged=()=>{};
</script>
</body>
</html>
